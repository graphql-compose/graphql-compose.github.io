<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Relations between Types · graphql-compose</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;The most important part of GraphQL is a relation between types.&lt;/p&gt;
"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Relations between Types · graphql-compose"/><meta property="og:type" content="website"/><meta property="og:url" content="https://graphql-compose.github.io/index.html"/><meta property="og:description" content="&lt;p&gt;The most important part of GraphQL is a relation between types.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/logo.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-83022112-3', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.png" alt="graphql-compose"/><h2 class="headerTitleWithLogo">graphql-compose</h2></a><a href="/versions.html"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/next/intro/quick-start.html" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/docs/next/api/SchemaComposer.html" target="_self">API</a></li><li class="siteNavGroupActive"><a href="/docs/next/plugins/list-of-plugins.html" target="_self">Plugins</a></li><li class=""><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://opencollective.com/graphql-compose" target="_self">Donate</a></li><li class=""><a href="https://github.com/graphql-compose/graphql-compose" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Basics</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/next/intro/prerequisites.html">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/next/intro/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/intro/quick-start.html">Quick Start Guide</a></li><li class="navListItem"><a class="navItem" href="/docs/next/intro/live-demos.html">Live Demos</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Basics</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/next/basics/understanding-types.html">Type creation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/basics/type-modification.html">Type modification</a></li><li class="navListItem"><a class="navItem" href="/docs/next/basics/what-is-resolver.html">Resolvers</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/next/basics/understanding-relations.html">Relations between Types</a></li><li class="navListItem"><a class="navItem" href="/docs/next/basics/generating-schema.html">Generating Schema</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/next/api/SchemaComposer.html">SchemaComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/ObjectTypeComposer.html">ObjectTypeComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/InputTypeComposer.html">InputTypeComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/ScalarTypeComposer.html">ScalarTypeComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/EnumTypeComposer.html">EnumTypeComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/InterfaceTypeComposer.html">InterfaceTypeComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/UnionTypeComposer.html">UnionTypeComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/ListComposer.html">ListComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/NonNullComposer.html">NonNullComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/ThunkComposer.html">ThunkComposer</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/Resolver.html">Resolver</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/TypeMapper.html">TypeMapper</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api/misc-api-methods.html">API misc</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Plugins</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/next/plugins/list-of-plugins.html">Plugins list</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-mongoose.html">Mongoose plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-elasticsearch.html">ElasticSearch plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-json.html">Json plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-relay.html">Relay plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-connection.html">Connection plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-pagination.html">Pagination plugin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/plugins/plugin-aws.html">AWS plugin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guide</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/next/guide/wrapping-rest-api.html">Wrapping REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/next/guide/file-uploads.html">File uploads</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/graphql-compose/graphql-compose/edit/master/docs/basics/understanding-relations.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Relations between Types</h1></header><article><div><span><p>The most important part of GraphQL is a relation between types.</p>
<h2><a class="anchor" aria-hidden="true" id="relation-via-fieldconfig"></a><a href="#relation-via-fieldconfig" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relation via FieldConfig</h2>
<p>Assume you have <code>Author</code> and <code>Post</code> types.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { schemaComposer } <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql-compose'</span>;

<span class="hljs-keyword">const</span> AuthorTC = schemaComposer.createObjectTC({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Author'</span>,
  <span class="hljs-attr">fields</span>: {
    <span class="hljs-attr">id</span>: <span class="hljs-string">'Int!'</span>,
    <span class="hljs-attr">firstName</span>: <span class="hljs-string">'String'</span>,
    <span class="hljs-attr">lastName</span>: <span class="hljs-string">'String'</span>,
  },
});

<span class="hljs-keyword">const</span> PostTC = schemaComposer.createObjectTC({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Post'</span>,
  <span class="hljs-attr">fields</span>: {
    <span class="hljs-attr">id</span>: <span class="hljs-string">'Int!'</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-string">'String'</span>,
    <span class="hljs-attr">votes</span>: <span class="hljs-string">'Int'</span>,
    <span class="hljs-attr">authorId</span>: <span class="hljs-string">'Int'</span>,
  },
});
</code></pre>
<p>GraphQL allows to create additional fields in our types, thus providing data from another type. For example, we may add a field <code>posts</code> to the <code>Author</code> type and write a <code>resolve</code> function, so that this field will return an array of posts only for the current Author.</p>
<p>It can be done in the following manner:</p>
<pre><code class="hljs css language-js">AuthorTC.addFields({
  <span class="hljs-attr">posts</span>: {
    <span class="hljs-attr">type</span>: [PostTC], <span class="hljs-comment">// array of Posts</span>
    resolve: <span class="hljs-function">(<span class="hljs-params">author, args, context, info</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> DB.Posts.find({ <span class="hljs-attr">authorId</span>: author.id });
    },
  },
});
</code></pre>
<p>It's quite easy. But now let's improve our relation and add new arguments, <code>limit</code> and <code>skip</code>:</p>
<pre><code class="hljs css language-js">AuthorTC.addFields({
  <span class="hljs-attr">posts</span>: {
    <span class="hljs-attr">type</span>: [PostTC], <span class="hljs-comment">// array of Posts</span>
    args: {
      <span class="hljs-attr">limit</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Int'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-number">10</span>,
      },
      <span class="hljs-attr">skip</span>: <span class="hljs-string">'Int'</span>,
    },
    <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">author, args, context, info</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> DB.Posts
        .find({ <span class="hljs-attr">authorId</span>: author.id })
        .limit(args.limit)
        .skip(args.skip || <span class="hljs-number">0</span>);
    },
  },
});
</code></pre>
<p>What if we want to provide a <code>filter</code> argument, which adds the ability to filter by creation date, and min number of votes?
That would be achieved by the following code:</p>
<pre><code class="hljs css language-js">AuthorTC.addFields({
  <span class="hljs-attr">posts</span>: {
    <span class="hljs-attr">type</span>: [PostTC], <span class="hljs-comment">// array of Posts</span>
    args: {
      <span class="hljs-attr">limit</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Int'</span>,
        <span class="hljs-attr">defaultValue</span>: <span class="hljs-number">10</span>,
      },
      <span class="hljs-attr">skip</span>: <span class="hljs-string">'Int'</span>,
      <span class="hljs-attr">filter</span>: <span class="hljs-string">`
        input PostsFilterInput {
          createdAtMin: Date
          votesMin: Int
        }
      `</span>,
    },
    <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">source, args, context, info</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> criteria = { <span class="hljs-attr">authorId</span>: source.id };
      <span class="hljs-keyword">if</span> (args.filter) {
        <span class="hljs-keyword">if</span> (args.filter.createdAtMin) criteria.createdAt = { <span class="hljs-attr">$gt</span>: args.filter.createdAtMin };
        <span class="hljs-keyword">if</span> (args.filter.votesMin) criteria.votes = { <span class="hljs-attr">$gt</span>: args.filter.votesMin };
      }
      <span class="hljs-keyword">return</span> DB.Posts
        .find(criteria)
        .limit(args.limit)
        .skip(args.skip || <span class="hljs-number">0</span>);
    },
  },
});
</code></pre>
<p>This would work just fine, but it has become quite a lot of code. And what if we have other Types with relations with Posts (eg. Reviewer, Reader)? Copy/pasting our <code>resolve</code> method is probably not a good idea. That's because in the future we may want to add a new <code>filter</code> property, and that would mean scanning all of our code to add additional logic in all <code>FieldConfigs</code>. The next section will detail a better approach to this problem.</p>
<h2><a class="anchor" aria-hidden="true" id="relation-via-resolver"></a><a href="#relation-via-resolver" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relation via Resolver</h2>
<p><code>graphql-compose</code> provides a <strong><a href="/docs/next/basics/what-is-resolver.html">Resolver</a></strong> class that allows using the same FieldConfigs in different Types. We may create a Resolver defining  <code>type</code>, <code>args</code> and a <code>resolve</code> function, then reuse it everywhere we need it in our Schema.</p>
<p>However if we define our <code>posts</code> resolver in a separate file, we'll then face another problem:</p>
<ul>
<li>in <code>Author</code> type we will use <code>criteria = { authorId: source.id }</code> for the resolve method;</li>
<li>in <code>Reviewer</code> - <code>criteria = { reviewers: { $has: source.id } }</code> and so on.</li>
</ul>
<p>In this case it's better to improve <code>args.filter</code> by allowing to set <code>authorId</code> and <code>reviewerId</code> via arguments:</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { schemaComposer } <span class="hljs-keyword">from</span> <span class="hljs-string">'graphql-compose'</span>;

<span class="hljs-keyword">const</span> postsResolver = schemaComposer.createResolver({
  <span class="hljs-attr">type</span>: [PostTC], <span class="hljs-comment">// array of Posts</span>
  args: {
    <span class="hljs-attr">limit</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'Int'</span>,
      <span class="hljs-attr">defaultValue</span>: <span class="hljs-number">10</span>,
    },
    <span class="hljs-attr">skip</span>: <span class="hljs-string">'Int'</span>,
    <span class="hljs-attr">filter</span>: <span class="hljs-string">`
      input PostsFilterInput {
        createdAtMin: Date
        votesMin: Int
        authorId: ID
        reviewerId: ID
      }
    `</span>,
  },
  <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">source, args, context, info</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { filter } = args;
    <span class="hljs-keyword">const</span> criteria = {};
    <span class="hljs-keyword">if</span> (filter) {
      <span class="hljs-keyword">if</span> (filter.createdAtMin) criteria.createdAt = { <span class="hljs-attr">$gt</span>: filter.createdAtMin };
      <span class="hljs-keyword">if</span> (filter.votesMin) criteria.votes = { <span class="hljs-attr">$gt</span>: filter.votesMin };
      <span class="hljs-keyword">if</span> (filter.authorId) criteria.authorId = filter.authorId;
      <span class="hljs-keyword">if</span> (filter.reviewerId) criteria.reviewerId = { <span class="hljs-attr">$has</span>: filter.reviewerId };
    }
    <span class="hljs-keyword">return</span> DB.Posts
      .find(criteria)
      .limit(args.limit)
      .skip(args.skip || <span class="hljs-number">0</span>);
  },
});
</code></pre>
<p>And now we may create relations via <code>ObjectTypeComposer.addRelation</code> method like so:</p>
<pre><code class="hljs css language-js">AuthorTC.addRelation(<span class="hljs-string">'posts'</span>, {
  <span class="hljs-attr">resolver</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> postsResolver,
  <span class="hljs-attr">prepareArgs</span>: {
    <span class="hljs-attr">filter</span>: <span class="hljs-function"><span class="hljs-params">source</span> =&gt;</span> ({ <span class="hljs-attr">authorId</span>: source.id }),
  },
  <span class="hljs-attr">projection</span>: { <span class="hljs-attr">id</span>: <span class="hljs-literal">true</span> },
});

ReviewerTC.addRelation(<span class="hljs-string">'posts'</span>, {
  <span class="hljs-attr">resolver</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> postsResolver,
  <span class="hljs-attr">prepareArgs</span>: {
    <span class="hljs-attr">filter</span>: <span class="hljs-function"><span class="hljs-params">source</span> =&gt;</span> ({ <span class="hljs-attr">reviewerId</span>: source.id }),
  },
  <span class="hljs-attr">projection</span>: { <span class="hljs-attr">id</span>: <span class="hljs-literal">true</span> },
});
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="objecttypecomposeraddrelation"></a><a href="#objecttypecomposeraddrelation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ObjectTypeComposer.addRelation()</h2>
<p><code>addRelation</code> method has the following arguments:</p>
<pre><code class="hljs css language-js">ObjectTypeComposer.addRelation(
  fieldName: string,
  <span class="hljs-attr">opts</span>: {
    <span class="hljs-attr">resolver</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> Resolver,
    prepareArgs?: ObjectTypeComposerRelationArgsMapper,
    projection?: ProjectionType,
    description?: string,
    deprecationReason?: string,
  })
): ObjectTypeComposer&lt;any, any&gt;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="resolver"></a><a href="#resolver" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>resolver</h3>
<p>Should be an arrow function that returns <code>Resolver</code>. Wrapping resolver in an arrow function helps solving the <code>hoisting</code> problem (when two types import each other).</p>
<h3><a class="anchor" aria-hidden="true" id="prepareargs"></a><a href="#prepareargs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>prepareArgs</h3>
<p>At runtime we should have the ability to prepare (ie. assign a value to) the args that will be passed to Resolver.</p>
<p>For example our Resolver has the arguments <code>filter</code>, <code>limit</code>, <code>skip</code> and <code>sort</code>.
<code>prepareArgs</code> provides a way to set them up:</p>
<ul>
<li><code>limit: 10</code> - hides <code>limit</code> arg from schema and set it equal to 10</li>
<li><code>filter: (source) =&gt; value</code> - hides <code>filter</code> arg form schema and at runtime evaluate its value</li>
<li><code>sort: null</code> - disables argument (hides it from schema and do not pass it to resolver)</li>
<li>all undescribed args (like <code>skip</code>) will be avaliable in the schema and will be avaliable in query</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="projection"></a><a href="#projection" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>projection</h3>
<p>Is a very useful option for extending requested fields in your query. It's very good practice to request from database only the fields included in our query. But sometimes we need additional fields, for example to provide the <code>findById</code> resolver with an <code>authorId</code>. For this purpose we can use <code>projection</code>.</p>
<pre><code class="hljs css language-js">PostTC.addRelation(<span class="hljs-string">'author'</span>, {
  <span class="hljs-attr">resolver</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> AuthorTC.getResolver(<span class="hljs-string">'findById'</span>),
  <span class="hljs-attr">prepareArgs</span>: {
    <span class="hljs-attr">id</span>: <span class="hljs-function">(<span class="hljs-params">source</span>) =&gt;</span> source.authorId,
  },
  <span class="hljs-attr">projection</span>: { <span class="hljs-attr">authorId</span>: <span class="hljs-literal">true</span> },
});
</code></pre>
<p>So the query</p>
<pre><code class="hljs css language-js">{
  post {
    author {
      firstName
    }
  }
}
</code></pre>
<p>will be transformed into</p>
<pre><code class="hljs css language-js">{
  post {
    author {
      firstName
    }
    authorId # &lt;--- added by `projection` option
  }
}
</code></pre>
<p>Without <code>projection</code> the resolver would try to populate the <code>author</code> field, but <code>args.authorId</code> would be <code>undefined</code>. It would therefore be impossible for the query filter to find matching <code>authors</code> and populate the <code>author</code> field. Normally when a client wants to retrieve the <code>author</code> field in a GraphQL Query, it would also need to provide the <code>authorId</code> explicitly. By using a <code>projection</code> we lift that responsility from the client, making querying easier and less cluttered.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/next/basics/what-is-resolver.html"><span class="arrow-prev">← </span><span>Resolvers</span></a><a class="docs-next button" href="/docs/next/basics/generating-schema.html"><span>Generating Schema</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#relation-via-fieldconfig">Relation via FieldConfig</a></li><li><a href="#relation-via-resolver">Relation via Resolver</a></li><li><a href="#objecttypecomposeraddrelation">ObjectTypeComposer.addRelation()</a><ul class="toc-headings"><li><a href="#resolver">resolver</a></li><li><a href="#prepareargs">prepareArgs</a></li><li><a href="#projection">projection</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><div><span><script src="/js/pjax-api.js"></script><script>
      window.foo = new Pjax({
        areas: [
          // try to use the first query.
          '.mainContainer, .onPageNav, .docsNavContainer .toc .navWrapper',
          // fallback
          'body'
        ],
        link: '.docsNavContainer:not(.docsSliderActive) a',
        update: {
          script: false,
        }
      });

      if (document && document.addEventListener) {
        document.addEventListener('pjax:ready', function (e) {
          if (ga) ga('send', 'pageview', location.pathname);
        });
      }

      var languagesMenuItemCopy = document.getElementById("languages-menu");
      if (languagesMenuItemCopy) {
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });
      }
      </script></span></div><section class="sitemap"><span class="nav-home" style="height:1px"></span><div><h5>Docs</h5><a href="/docs/intro/quick-start.html">Get Started</a><a href="/docs/api/SchemaComposer.html">API Reference</a><a href="/docs/plugins/list-of-plugins.html">Plugins</a><a href="https://graphql-compose.herokuapp.com/" target="_blank">Live Demo</a></div><div><h5>Community</h5><a href="https://github.com/graphql-compose/graphql-compose/issues" target="_blank">Issues</a><a href="https://twitter.com/nodkz" target="_blank">Twitter</a><a href="https://opencollective.com/graphql-compose" target="_blank">Donate</a></div><div><h5>More</h5><a href="https://www.npmjs.com/package/graphql-compose" target="_blank">NPM</a><a href="https://github.com/graphql-compose/graphql-compose" target="_blank">GitHub</a><a class="github-button" href="https://github.com/graphql-compose/graphql-compose" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2022  <span style="color:black">🇰🇿</span> Pavel Chertorogov @nodkz</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '34b5c77954100fe8e57575f8dfd60185',
                indexName: 'graphql-compose',
                inputSelector: '#search_input_react',
                algoliaOptions: {"hitsPerPage":10}
              });
            </script></body></html>